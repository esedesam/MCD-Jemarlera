---
title: "Práctica 3 de Estadística"
author: "Jesús Martínez Leal, Samuel Ortega Mediavilla, Pablo Vicente Martínez"
date: "`r Sys.Date()`"
output:
  html_document:
    echo: yes
    number_sections: no
    theme: readable
    toc: yes
subtitle: Master Ciencia de Datos UV
---

```{r setup, cache = F, echo = F, message = F, warning = F, tidy = F}
# Configuración general de chunks
library(knitr)
options(width = 100)
knitr::opts_chunk$set(echo = T, message = T, error = F, warning = F, comment = NA, dpi = 100, tidy = T, cache.path = '.cache/', fig.path = './figure/', include = T)
```
Como es habitual, cargamos las librerías que necesitamos al inicio del documento.

```{r librerias, message = T, include = T, echo = T}
# Carga de librerías necesarias con pacman
if (!require(pacman)) {
  install.packages("pacman")
  library(pacman)
}
pacman::p_load(readr, stringr, tidyr, dplyr, readxl, ggplot2, forcats, MASS, statmod, kableExtra, greekLetters)

set.seed(33)
```


## Ejercicio 2

En este problema estudiamos la distribución del peso del cerebro humano en adultos y su relación con el tamaño de la cabeza. Los datos se encuentran en el marco de datos brainhead, que contiene las siguientes mediciones para 237 sujetos:

  • agerange 1 si la edad ∈ [20, 46], 2 si la edad es > 46
  • headsize volumen de la cabeza en cm³.
  • brainweight peso del cerebro en gramos.
  
### Pregunta 2.1 

Comprueba si la distribución del peso del cerebro se puede asumir como Gaussiana, utilizando las herramientas que hemos visto en el curso. Comprueba si la suposición de normalidad es válida también individualmente para los dos grupos de edad (agerange = 1, 2).


```{r}
brainhead <- read.csv("./data/brainhead.csv")

qqnorm(y = brainhead$brainweight)
qqline(y = brainhead$brainweight)
```

Dado que los puntos se distribuyen a lo largo de la diagonal del gráfico, podemos afirmar que siguen un adistribución gaussiana.

Aplicándolo para los distintos rangos de edad por separado:

```{r}
agerange_1 <- brainhead[brainhead$agerange == 1, ]
agerange_2 <- brainhead[brainhead$agerange == 2, ]


qqnorm(y = agerange_1$brainweight, main = "Normal Q-Q Plot (Age Range [20, 46])")
qqline(y = agerange_1$brainweight)

qqnorm(y = agerange_2$brainweight, main = "Normal Q-Q Plot (Age Range > 46)")
qqline(y = agerange_2$brainweight)
```

Siguiendo el mismo razonamiento que antes, podemos suponer que ambas siguen distribuciones gaussianas.

### Pregunta 2.2

Considera la siguiente pregunta:

¿Existe una diferencia significativa entre el valor medio del peso del cerebro para sujetos mayores (edad > 46) y sujetos más jóvenes (edad ≤ 46)?

Responde a la pregunta anterior con un procedimiento estadístico apropiado y comenta los resultados.

```{r}
realizar_t_test <- function(x, y, alternative = c("two.sided")) {
  
  alpha <- 0.05

  t_test_result <- t.test(x, y, alternative = alternative, paired = FALSE, conf.level = 0.95, var.equal = FALSE)
  
  cat("El valor obtenido para el p-value es:", paste0(t_test_result$p.value, ".\n"))
  
  if (t_test_result$p.value < alpha) {
    cat("Se rechaza la hipótesis nula.\n\n")
  } else {
    cat("No se puede rechazar la hipótesis nula.\n\n")
  }
}

realizar_t_test(agerange_1$brainweight, agerange_2$brainweight)
```

```{r}
length(agerange_1$brainweight)
length(agerange_2$brainweight)
```



